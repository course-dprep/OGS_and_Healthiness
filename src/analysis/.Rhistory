x = "Time Period (weeks)",
y = "Cumulative Average Treatment Effect (ATT)"
) +
theme_minimal() +  # Apply a minimal theme for aesthetics
theme(
plot.title = element_text(hjust = 0.5),  # Center the title
panel.grid.major = element_line(color = "grey80"),  # Major grid lines
panel.grid.minor = element_blank()  # Remove minor grid lines
)
plot <- ggplot(time_window_effects_df, aes(x = Period, y = ATT)) +
geom_point(size = 3, color = "blue") +  # Points for the ATT
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper), width = 0.2, color = "blue") +  # Error bars for CI
scale_x_continuous(breaks = seq(from = min(time_window_effects_df$Period),
to = max(time_window_effects_df$Period),
by = 1)) +  # Adjust breaks as necessary
labs(
title = "Dynamic Effects of Online Grocery Adoption (8-week Time Window)",
x = "Time Period (weeks)",
y = "Average Treatment Effect (ATT)"
) +
theme_minimal() +  # Use a minimal theme
theme(
plot.title = element_text(hjust = 0.5),  # Center the title
panel.grid.major = element_line(color = "grey80"),  # Major grid lines
panel.grid.minor = element_blank()  # Remove minor grid lines
)
print(plot)
library(ggdid)
ggplot(time_window_effects_df, aes(x = Period, y = ATT)) +
geom_point(size = 3, color = "blue") +  # Points for the ATT
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper), width = 0.2, color = "blue") +  # Error bars for CI
scale_x_continuous(breaks = seq(from = min(time_window_effects_df$Period),
to = max(time_window_effects_df$Period),
by = 1)) +  # Adjust breaks as necessary
labs(
title = "Dynamic Effects of Online Grocery Adoption (8-week Time Window)",
x = "Time Period (weeks)",
y = "Average Treatment Effect (ATT)"
) +
theme_minimal() +  # Use a minimal theme
theme(
plot.title = element_text(hjust = 0.5),  # Center the title
panel.grid.major = element_line(color = "grey80"),  # Major grid lines
panel.grid.minor = element_blank()  # Remove minor grid lines
)
ggplot(time_window_effects_df, aes(x = Period, y = ATT)) +
geom_point(size = 3, color = "black") +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper), width = 0.2, color = "black") +
scale_x_continuous(breaks = seq(from = min(time_window_effects_df$Period),
to = max(time_window_effects_df$Period),
by = 1)) +
labs(title = "Dynamic Effects of Online Grocery Adoption (8-week Time Window)",
x = "Time aroound adoption (weeks)",
y = "Average Treatment Effect (ATT)"
)
ggplot(time_window_effects_df, aes(x = Period, y = ATT)) +
geom_point(size = 3, color = "black") +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper), width = 0.2, color = "black") +
scale_x_continuous(breaks = seq(from = min(time_window_effects_df$Period),
to = max(time_window_effects_df$Period),
by = 1)) +
labs(title = "Dynamic Effects of Online Grocery Adoption (8-week Time Window)",
x = "Time aroound adoption (weeks)",
y = "Average Treatment Effect (ATT)") + theme_minimal()
View(time_window_effects_df)
ggdid(cohort_effects)
ggplot(cohort_effects_df, aes(x = Cohort, y = ATT)) +
geom_point(size = 3, color = "black") +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper), width = 0.2, color = "black") +
labs(title = "Cohort Effects of Online Grocery Adoption",
x = "Cohort",
y = "Average Treatment Effect (ATT)") +
theme_minimal()
t
t
ggplot(cohort_effects_df, aes(x = Cohort, y = ATT)) +
geom_point(size = 3, color = "black") +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper), width = 0.2, color = "black") +
labs(title = "Cohort Effects of Online Grocery Adoption",
x = "Cohort",
y = "Average Treatment Effect (ATT)") +
theme_minimal()
cohort_effects_df <- data.frame(
Cohort = cohort_effects$group,
ATT = cohort_effects$att.group,
Std_Error = cohort_effects$se.group,
CI_Lower = cohort_effects$att.group - 1.96 * cohort_effects$se.group,
CI_Upper = cohort_effects$att.group + 1.96 * cohort_effects$se.group)
ggplot(cohort_effects_df, aes(x = Cohort, y = ATT)) +
geom_point(size = 3, color = "black") +
geom_errorbar(aes(ymin = CI_Lower, ymax = CI_Upper), width = 0.2, color = "black") +
labs(title = "Cohort Effects of Online Grocery Adoption",
x = "Cohort",
y = "Average Treatment Effect (ATT)") +
theme_minimal()
View(cohort_effects_df)
View(cohort_effects)
install.packages(ggdid)
install.packages("ggdid")
library(ggdid)
library(ggdid)
cohort_effects_df <- data.frame(
Cohort = seq_along(cohort_effects$att.group),  # Create a sequence for cohort labels
ATT = cohort_effects$att.group,                 # Average Treatment Effect
Std_Error = cohort_effects$se.group,            # Standard Error
CI_Lower = cohort_effects$att.group - 1.96 * cohort_effects$se.group,  # Lower CI
CI_Upper = cohort_effects$att.group + 1.96 * cohort_effects$se.group   # Upper CI
)
View(cohort_effects)
View(cohort_effects_df)
cohort_effects_df <- data.frame(
Cohort = seq_along(cohort_effects$att.group),  # Create a sequence for cohort labels
ATT = cohort_effects$att.group,                 # Average Treatment Effect
Std_Error = cohort_effects$se.group,            # Standard Error
CI_Lower = cohort_effects$att.group - 1.96 * cohort_effects$se.group,  # Lower CI
CI_Upper = cohort_effects$att.group + 1.96 * cohort_effects$se.group   # Upper CI
)
# effects per cohort
cohort_effects <- aggte(did_model, type = "group", na.rm = TRUE)
rm(list=ls)
rm(list=ls())
# load required packages
library(data.table)
library(did)
# directory creation for analysis output
dir.create("../../gen/analysis/")
# load in dataset
weekly_baskets_2019 <- fread("../../gen/data_preparation/input/weekly_baskets_2019.csv")
# difference-in-differences analysis method from Callaway & Sant'Anna (2021) using did package
# method required a treated indicator
weekly_baskets_2019[, treated := ifelse(treatment_group == 1 & week_number >= cohort_period, 1, 0)]
weekly_baskets_2019[, panelist_numeric := as.numeric(factor(weekly_baskets_2019$panelist, levels = unique(weekly_baskets_2019$panelist)))]
# run did model
did_model <- att_gt(yname = "prop_expenditure_fruit_vegetables",
tname = "week_number",
idname = "panelist_numeric",
gname = "cohort_period",
control_group = "nevertreated",
xformla = ~1,
data = weekly_baskets_2019,
allow_unbalanced_panel = TRUE,
clustervars = "panelist")
# create result plots & tables
# average results of model
average_did_effect  <- aggte(did_model, type = "simple", na.rm = TRUE)
# confidence interval 8-week time window around online adoption
time_window_effects <- aggte(
did_model,
type = "dynamic",
min_e = -8,  max_e = 8, na.rm = TRUE)
# effects per cohort
cohort_effects <- aggte(did_model, type = "group", na.rm = TRUE)
results_list <- list(
average_did_effect = average_did_effect,
time_window_effects = time_window_effects,
cohort_effects = cohort_effects)
cs_group_effects <- aggte(did_model, type = "group", na.rm = TRUE)
cs_overall_avg  <- aggte(did_model, type = "simple", na.rm = TRUE)
ggdid(cs_group_effects)
library(did)
ggdid(cohort_effect)
cohort_effects
ggdid(cohort_effects)
ggdid(time_window_effects_df)
time_window_effects_df <- data.frame(
Period = time_window_effects$egt,
ATT = time_window_effects$att.egt,
Std_Error = time_window_effects$se.egt,
CI_Lower = time_window_effects$att.egt - 1.96 * time_window_effects$se.egt,
CI_Upper = time_window_effects$att.egt + 1.96 * time_window_effects$se.egt)
ggdid(time_window_effects_df)
ggdid(time_window_effects)
ggdid(time_window_effects)
ggdid(cohort_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Average Treatment Effect of Online Grocery Adoption in a 8-week time window") +
theme_minimal()  # Optional: add a minimal theme for better aesthetics
time_window_plot <- ggdid(time_window_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Average Treatment Effect of Online Grocery Adoption in a 8-week time window") +
theme_minimal()
# Render the plot
print(time_window_plot)
cohort_plot <- ggdid(cohort_effects)
cohort_plot
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week") +
theme_minimal()
# Render the plot
print(time_window_plot)
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week")
# Render the plot
print(time_window_plot)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Average Treatment Effect of Online Grocery Adoption in a 8-week time window")
# Render the plot
print(time_window_plot)
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week")
# Render the plot
print(cohort_plot)
time_window_plot <- ggdid(time_window_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Event study plot of Average Treatment Effect (ATT) over time")
# Render the plot
print(time_window_plot)
??rmarkdown:render
help(rmarkdown::render)
rmarkdown::render("model_results.Rmd", output_file = "Model results & Summaries.pdf", output_dir = "../../gen/analysis")
```{r, output, include=FALSE, message=FALSE, warning=FALSE}
rmarkdown::render("model_results.Rmd", output_file = "Model results & Summaries.pdf", output_dir = "../../gen/analysis")
dir.create("../../gen/paper")
rm(list=ls())
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
dir.create("../../gen/paper")
results_list <- readRDS("../../gen/analysis/did_effects_list.rds")
average_did_effect <- results_list$average_did_effect
time_window_effects <- results_list$time_window_effects
cohort_effects <- results_list$cohort_effects
average_effect_df <- data.frame(
ATT = average_did_effect$overall.att,
Std_Error = average_did_effect$overall.se,
CI_Lower = average_did_effect$overall.att - 1.96 * average_did_effect$overall.se,
CI_Upper = average_did_effect$overall.att + 1.96 * average_did_effect$overall.se)
kable(average_effect_df, caption = "Average Treatment Effect (ATT)") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
time_window_plot <- ggdid(time_window_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Event study plot of Average Treatment Effect (ATT) over time")
# Render the plot
print(time_window_plot)
cohort_plot <- ggdid(cohort_effects)
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week")
# Render the plot
print(cohort_plot)
rmarkdown::render("model_results.Rmd", output_file = "Model results & Summaries.pdf", output_dir = "../../gen/paper")
rm(list=ls())
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
dir.create("../../gen/paper")
results_list <- readRDS("../../gen/analysis/did_effects_list.rds")
average_did_effect <- results_list$average_did_effect
time_window_effects <- results_list$time_window_effects
cohort_effects <- results_list$cohort_effects
average_effect_df <- data.frame(
ATT = average_did_effect$overall.att,
Std_Error = average_did_effect$overall.se,
CI_Lower = average_did_effect$overall.att - 1.96 * average_did_effect$overall.se,
CI_Upper = average_did_effect$overall.att + 1.96 * average_did_effect$overall.se)
kable(average_effect_df, caption = "Average Treatment Effect (ATT)") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
time_window_plot <- ggdid(time_window_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Event study plot of Average Treatment Effect (ATT) over time")
# Render the plot
print(time_window_plot)
cohort_plot <- ggdid(cohort_effects)
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week")
# Render the plot
print(cohort_plot)
rmarkdown::render("model_results.Rmd", output_file = "Model results & Summaries.pdf", output_dir = "../../gen/paper")
rmarkdown::render("model_results.Rmd", output_file = "Model results & Summaries.pdf", output_dir = "../../gen/analysis")
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
results_list <- readRDS("../../gen/analysis/did_effects_list.rds")
average_did_effect <- results_list$average_did_effect
time_window_effects <- results_list$time_window_effects
cohort_effects <- results_list$cohort_effects
average_effect_df <- data.frame(
ATT = average_did_effect$overall.att,
Std_Error = average_did_effect$overall.se,
CI_Lower = average_did_effect$overall.att - 1.96 * average_did_effect$overall.se,
CI_Upper = average_did_effect$overall.att + 1.96 * average_did_effect$overall.se)
kable(average_effect_df, caption = "Average Treatment Effect (ATT)") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
time_window_plot <- ggdid(time_window_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Event study plot of Average Treatment Effect (ATT) over time")
# Render the plot
print(time_window_plot)
cohort_plot <- ggdid(cohort_effects)
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week")
# Render the plot
print(cohort_plot)
rmarkdown::render("model_results.Rmd", output_file = "Model results & Summaries.pdf", output_dir = "../../gen/analysis")
rm(list=ls())
rmarkdown::render("model_results.Rmd", output_file = "Model results & Summaries.pdf", output_dir = "../../gen/analysis/")
```{r include=FALSE, message=FALSE, warning=FALSE}
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
rmarkdown::render("model_results.Rmd", output_file = "Model results & Summaries.pdf", output_dir = "../../gen/analysis")
rmarkdown::render("model_results.Rmd", output_file = "Model results & Summaries.pdf", output_dir = "../../gen/analysis")
rm(list=ls())
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
results_list <- readRDS("../../gen/analysis/did_effects_list.rds")
average_did_effect <- results_list$average_did_effect
time_window_effects <- results_list$time_window_effects
cohort_effects <- results_list$cohort_effects
average_effect_df <- data.frame(
ATT = average_did_effect$overall.att,
Std_Error = average_did_effect$overall.se,
CI_Lower = average_did_effect$overall.att - 1.96 * average_did_effect$overall.se,
CI_Upper = average_did_effect$overall.att + 1.96 * average_did_effect$overall.se)
kable(average_effect_df, caption = "Average Treatment Effect (ATT)") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
time_window_plot <- ggdid(time_window_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Event study plot of Average Treatment Effect (ATT) over time")
# Render the plot
print(time_window_plot)
cohort_plot <- ggdid(cohort_effects)
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week")
# Render the plot
print(cohort_plot)
rmarkdown::render("model_results.Rmd", output_file = "Model results & Summaries.pdf", output_dir = "../../gen/analysis")
help(rmarkdown::render)
help(rmarkdown::render)
help(render)
rmarkdown::render("model_results.Rmd", output_format = "pdf_document", output_dir = "../../gen/paper")
rmarkdown::render("model_results.Rmd", output_file = "Results & Conclusion", output_format = "pdf_document", output_dir = "../../gen/paper")
library(tinytex)
install.packages("tinytex")
install.packages("tinytex")
library(tinytex)
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
library(tinytex)
results_list <- readRDS("../../gen/analysis/did_effects_list.rds")
average_did_effect <- results_list$average_did_effect
time_window_effects <- results_list$time_window_effects
cohort_effects <- results_list$cohort_effects
average_effect_df <- data.frame(
ATT = average_did_effect$overall.att,
Std_Error = average_did_effect$overall.se,
CI_Lower = average_did_effect$overall.att - 1.96 * average_did_effect$overall.se,
CI_Upper = average_did_effect$overall.att + 1.96 * average_did_effect$overall.se)
kable(average_effect_df, caption = "Average Treatment Effect (ATT)") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
time_window_plot <- ggdid(time_window_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Event study plot of Average Treatment Effect (ATT) over time")
# Render the plot
print(time_window_plot)
cohort_plot <- ggdid(cohort_effects)
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week")
# Render the plot
print(cohort_plot)
rmarkdown::render('model_results.Rmd', output_file = 'Results_and_Conclusion.pdf', output_format = 'pdf_document', output_dir = '../../gen/paper')
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
library(tinytex)
results_list <- readRDS("../../gen/analysis/did_effects_list.rds")
average_did_effect <- results_list$average_did_effect
time_window_effects <- results_list$time_window_effects
cohort_effects <- results_list$cohort_effects
average_effect_df <- data.frame(
ATT = average_did_effect$overall.att,
Std_Error = average_did_effect$overall.se,
CI_Lower = average_did_effect$overall.att - 1.96 * average_did_effect$overall.se,
CI_Upper = average_did_effect$overall.att + 1.96 * average_did_effect$overall.se)
kable(average_effect_df, caption = "Average Treatment Effect (ATT)") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
time_window_plot <- ggdid(time_window_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Event study plot of Average Treatment Effect (ATT) over time")
# Render the plot
print(time_window_plot)
cohort_plot <- ggdid(cohort_effects)
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week")
# Render the plot
print(cohort_plot)
rmarkdown::render('model_results.Rmd', output_file = 'Results_and_Conclusion.pdf', output_format = 'pdf_document', output_dir = '../../gen/paper')
rmarkdown::render('model_results.Rmd', output_file = 'Results_and_Conclusion.pdf', output_format = 'pdf_document', output_dir = '../../gen/paper')
rmarkdown::render('model_results.Rmd', output_file = 'Results_and_Conclusion.pdf', output_format = 'pdf_document', output_dir = '../../gen/paper')
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
library(tinytex)
results_list <- readRDS("../../gen/analysis/did_effects_list.rds")
average_did_effect <- results_list$average_did_effect
time_window_effects <- results_list$time_window_effects
cohort_effects <- results_list$cohort_effects
average_effect_df <- data.frame(
ATT = average_did_effect$overall.att,
Std_Error = average_did_effect$overall.se,
CI_Lower = average_did_effect$overall.att - 1.96 * average_did_effect$overall.se,
CI_Upper = average_did_effect$overall.att + 1.96 * average_did_effect$overall.se)
kable(average_effect_df, caption = "Average Treatment Effect (ATT)") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
time_window_plot <- ggdid(time_window_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Event study plot of Average Treatment Effect (ATT) over time")
# Render the plot
print(time_window_plot)
cohort_plot <- ggdid(cohort_effects)
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week")
# Render the plot
print(cohort_plot)
rmarkdown::render('model_results.Rmd', output_file = 'Results_and_Conclusion.pdf', output_format = 'pdf_document', output_dir = '../../gen/paper')
rmarkdown::render('model_results.Rmd',
output_file = 'Results_and_Conclusion.pdf',
output_format = 'pdf_document',
output_dir = '../../gen/paper')
rm(list=ls())
---
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
library(tinytex)
```
results_list <- readRDS("../../gen/analysis/did_effects_list.rds")
average_did_effect <- results_list$average_did_effect
time_window_effects <- results_list$time_window_effects
cohort_effects <- results_list$cohort_effects
---
title: "Model results & summaries"
---
title: "Model results and summaries"
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
library(tinytex)
results_list <- readRDS("../../gen/analysis/did_effects_list.rds")
average_did_effect <- results_list$average_did_effect
time_window_effects <- results_list$time_window_effects
cohort_effects <- results_list$cohort_effects
average_effect_df <- data.frame(
ATT = average_did_effect$overall.att,
Std_Error = average_did_effect$overall.se,
CI_Lower = average_did_effect$overall.att - 1.96 * average_did_effect$overall.se,
CI_Upper = average_did_effect$overall.att + 1.96 * average_did_effect$overall.se)
kable(average_effect_df, caption = "Average Treatment Effect (ATT)") %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed"))
time_window_plot <- ggdid(time_window_effects)
# Modify the title
time_window_plot <- time_window_plot +
ggtitle("Figure 1. Event study plot of Average Treatment Effect (ATT) over time")
# Render the plot
print(time_window_plot)
cohort_plot <- ggdid(cohort_effects)
# Modify the title
cohort_plot <- cohort_plot +
ggtitle("Figure 2. Average Treatment Effect (ATT) per cohort (adoption-week")
# Render the plot
print(cohort_plot)
rmarkdown::render('model_results.Rmd', output_file = 'Results_and_Conclusion.pdf', output_format = 'pdf_document', output_dir = '../../gen/paper')
```{r, include=FALSE, message=FALSE, warning=FALSE}
library(data.table)
library(data.table)
library(tidyr)
library(ggplot2)
library(kableExtra)
library(did)
library(tinytex)
